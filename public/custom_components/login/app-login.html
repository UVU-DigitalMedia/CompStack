<link rel="import" href="login-loginform.html">
<dom-module id="app-login">

    <template>

        <firebase-auth id="auth" user="{{user}}" on-error="loginError"></firebase-auth>

        <div class="topBar">

            <div class="topRight">

                <div id="loginFormToggle" on-tap="showLogin" class$="formToggle {{loginActive}}">
                    <p>Login</p>
                </div>

                <div id="regFormToggle" on-tap="showRegistration" class$="formToggle {{regActive}}">
                    <p>Register</p>
                </div>

            </div>

            <h1>Competency Browser</h1>

            <p>A tool for viewing and editing competencies.</p>

        </div>

        <login-loginform auth="{{auth}}" signed-in="{{signedIn}}" hidden$="{{hideLogin}}" user="{{user}}"></login-loginform>

        <login-registerform auth="{{auth}}" hidden$="{{hideRegistration}}"></login-registerform>

    </template>

    <style>

        :host {
            display: block;
            width: 800px;
            height: 500px;
            background-color: #f6f7fa;
            color: #8492af;
            margin: 100px auto auto auto;
        }
        h1, p{
            margin: 0;
            padding: 0;
        }
        .topBar {
            margin: 0;
            padding: 5px 0px 5px 20px;
            background-color: #3c7d15;
            color: #fff;
            height: 60px;
        }
        .topRight {
            float: right;
            display: inline-block;
            vertical-align: middle;
            margin: 0;
            padding: 0;
            height: 100%;
        }
        .formToggle {
            display: table-cell;
            width: 100px;
            height: 60px;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;

        }
        .active {
            border-bottom: #385768 solid 5px;
        }
        h2 {
            text-align: center;
        }
        .line {
            display: inline-block;
            background-color: #8492af;
            height: 1px;
            width: 100px;
            vertical-align: middle;
        }
        .login {
            display: block;
            text-align: center;
            color: #fff;
            background-color: #385768;
            border-radius: 20px;
            width: 250px;
            margin: 24px auto 24px auto;
        }

    </style>

    <script>

        Polymer({

            is: 'app-login',

            properties: {

                auth: Object,
                user: {
                    type: Object,
                    notify: true
                },
                signedIn: {
                    type: Boolean,
                    notify: true
                },
                hideLogin: {
                    type: Boolean,
                    value: false
                },

                hideRegistration: {
                    type: Boolean,
                    value: true
                }

            },

            ready: function(){

                this.loginActive = 'active';

            },

            showLogin: function() {

                this.hideLogin = false;
                this.hideRegistration = true;
                this.loginActive = 'active';
                this.regActive = '';

            },

            showRegistration: function() {

                this.hideLogin = true;
                this.hideRegistration = false;
                this.loginActive = '';
                this.regActive = 'active';

            },

            loginError: function(error) {

                console.log(error.detail.message);

            },

            logout: function(){

                auth.signOut()
                    .then(this.onLogout.bind(this))
                    .catch(this.loginError);

            },

            onLogout: function(response) {

                this.signedIn = false;

            }

        });

    </script>

</dom-module>
